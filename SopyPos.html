<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Forma Canónica SOP/POS</title>
<link rel="stylesheet" href="estilos.css">
<script src="script.js"></script>
</head>
<body>
<div class="container">
    <h2>Forma Canónica Estándar SOP/POS</h2>
    
    <div class="info-box">
        <strong>Instrucciones:</strong> Ingresa una expresión para obtener sus formas canónicas SOP (Suma de Productos) y POS (Producto de Sumas)
    </div>

    <div class="input-group">
        <label>Ingrese la expresión booleana:</label>
        <input id="expresion" placeholder="Ej: A¬B+C(D+¬A)" oninput="validarInput(this)" style="font-size: 18px; padding: 16px; min-height: 50px;">
    </div>

    <div class="button-group">
        <button class="secondary" onclick="insertarNegacion('expresion')">Insertar ¬</button>
        <button class="primary" onclick="procesarPagina4()">Procesar</button>
        <button class="danger" onclick="limpiarFormulario('expresion', 'resultado')">Limpiar</button>
    </div>

    <div id="errorMsg"></div>
    
    <h3>Tabla de Verdad:</h3>
    <div id="tablita"></div>

    <h3>Forma Canónica SOP (Suma de Productos)</h3>
    <div id="resultadoSOP" class="resultado"></div>
    <div id="notacionSOP" class="notacion-matematica"></div>

    <h3>Forma Canónica POS (Producto de Sumas)</h3>
    <div id="resultadoPOS" class="resultado"></div>
    <div id="notacionPOS" class="notacion-matematica"></div>
</div>

<script>
function procesarPagina4(){
    const exp=document.getElementById("expresion").value.trim();
    const errorDiv = document.getElementById("errorMsg");
    errorDiv.innerHTML = "";

    if(!exp) {
        errorDiv.innerHTML = '<div class="error">❌ Por favor ingrese una expresión</div>';
        return;
    }

    if(!validarExpresion(exp)) {
        errorDiv.innerHTML = '<div class="error">❌ Expresión no válida. Revise paréntesis y operadores</div>';
        return;
    }

    try {
        const vars=detectarVars(exp);
        if(vars.length === 0) {
            errorDiv.innerHTML = '<div class="error">❌ Debe incluir al menos una variable (A, B, C, D)</div>';
            return;
        }

        const resultados=evaluarExpresion(exp, vars);
        const minExp=obtenerMinterms(resultados, vars);
        const maxExp=obtenerMaxterms(resultados, vars);
        const sumatoria=generarSumatoria(resultados, vars);
        const productoria=generarProductoria(resultados, vars);
        
        // Mostrar tabla de verdad
        document.getElementById("tablita").innerHTML = generarTablaVerdad(exp, vars);
        
        document.getElementById("resultadoSOP").innerHTML=`
            <div class="result-row">
                <span class="result-label">SOP Canónica:</span>
                <span class="result-value">${minExp}</span>
            </div>
        `;
        
        document.getElementById("notacionSOP").innerHTML=`
            <div class="result-row" style="background-color: #e8f5e9; border-left: 4px solid #4caf50;">
                <span class="result-value" style="font-size: 16px; color: #2e7d32;">${sumatoria}</span>
            </div>
        `;
        
        document.getElementById("resultadoPOS").innerHTML=`
            <div class="result-row">
                <span class="result-label">POS Canónica:</span>
                <span class="result-value">${maxExp}</span>
            </div>
        `;
        
        document.getElementById("notacionPOS").innerHTML=`
            <div class="result-row" style="background-color: #e3f2fd; border-left: 4px solid #1976d2;">
                <span class="result-value" style="font-size: 16px; color: #0d47a1;">${productoria}</span>
            </div>
        `;
    } catch(e) {
        errorDiv.innerHTML = '<div class="error">❌ Error al procesar la expresión: ' + e.message + '</div>';
    }
}
</script>
</body>
</html>
